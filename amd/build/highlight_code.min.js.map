{"version":3,"sources":["../src/highlight_code.js"],"names":["define","applyAceHighlighting","ace","root","highlight","require","codeElements","getElementsByClassName","element","i","hasAttribute","closest","mode","getAttribute","startLineNumber","parseInt","showGutter","classList","contains","firstLineNumber","fontSize","children","length","style","setAttribute","init","window","document"],"mappings":"AA0BAA,OAAM,oCAAC,EAAD,CAAK,UAAW,CAQlB,QAASC,CAAAA,CAAT,CAA8BC,CAA9B,CAAmCC,CAAnC,CAAyC,CAIrC,OAHIC,CAAAA,CAAS,CAAGF,CAAG,CAACG,OAAJ,CAAY,0BAAZ,CAGhB,CAFIC,CAAY,CAAGH,CAAI,CAACI,sBAAL,CAA4B,oBAA5B,CAEnB,cACI,GAAIC,CAAAA,CAAO,CAAGF,CAAY,CAACG,CAAD,CAA1B,CAEA,GAAID,CAAO,CAACE,YAAR,CAAqB,oBAArB,GAA8C,CAACF,CAAO,CAACG,OAAR,CAAgB,qBAAhB,CAAnD,CAA2F,CACrF,gBACL,CAEGC,CAAI,CAAG,iBAPf,CAQI,GAAIJ,CAAO,CAACE,YAAR,CAAqB,MAArB,CAAJ,CAAkC,CAC9BE,CAAI,CAAG,YAAcJ,CAAO,CAACK,YAAR,CAAqB,MAArB,CACxB,CAEGC,CAAe,CAAG,CAZ1B,CAaI,GAAIN,CAAO,CAACE,YAAR,CAAqB,mBAArB,CAAJ,CAA+C,CAC3CI,CAAe,CAAGC,QAAQ,CAACP,CAAO,CAACK,YAAR,CAAqB,mBAArB,CAAD,CAC7B,CAEDT,CAAS,CAACI,CAAD,CAAU,CACfI,IAAI,CAAEA,CADS,CAEfI,UAAU,CAAGR,CAAO,CAACE,YAAR,CAAqB,mBAArB,GAA6CF,CAAO,CAACS,SAAR,CAAkBC,QAAlB,CAA2B,mBAA3B,CAF3C,CAGfC,eAAe,CAAEL,CAHF,CAAV,CAIN,UAAW,CACN,GAAIM,CAAAA,CAAQ,CAAG,MAAf,CACA,GAAIZ,CAAO,CAACE,YAAR,CAAqB,WAArB,CAAJ,CAAuC,CACnCU,CAAQ,CAAGZ,CAAO,CAACK,YAAR,CAAqB,WAArB,CACd,CACD,GAAIQ,CAAAA,CAAQ,CAAGb,CAAO,CAACD,sBAAR,CAA+B,sBAA/B,CAAf,CACA,GAAsB,CAAlB,CAAAc,CAAQ,CAACC,MAAb,CAAyB,CACrBD,CAAQ,CAAC,CAAD,CAAR,CAAYE,KAAZ,CAAkB,WAAlB,EAAiCH,CACpC,CAEDZ,CAAO,CAACgB,YAAR,CAAqB,oBAArB,CAA2C,EAA3C,CACP,CAfQ,CAjBb,EAASf,CAAC,CAAC,CAAX,CAAcA,CAAC,CAAGH,CAAY,CAACgB,MAA/B,CAAuCb,CAAC,EAAxC,CAA4C,IAOpCG,CAAAA,CAPoC,CAYpCE,CAZoC,yBAIlC,QA6BT,CACJ,CAED,MAAO,CACHW,IAAI,CAAE,eAAW,CACb,GAAIC,MAAM,CAACxB,GAAX,CAAgB,CACZD,CAAoB,CAACyB,MAAM,CAACxB,GAAR,CAAayB,QAAb,CACvB,CACJ,CALE,CAOV,CAvDK,CAAN","sourcesContent":["/**\n * This file is part of Moodle - http:moodle.org/\n *\n * Moodle is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Moodle is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Moodle.  If not, see <http:www.gnu.org/licenses/>.\n */\n\n/**\n * JavaScript for implementing the highlight_code functionality of the\n * ace_line filter (q.v.)\n *\n * @module filter_ace_inline/highlight_code\n * @copyright  Richard Lobb, 2021, The University of Canterbury\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([], function() {\n    /**\n     * Replace all <pre> elements in the document rooted at root that have\n     * class ace-highlight-code with Ace editor windows that display the\n     * code in whatever language has been set.\n     * @param {object} ace The Ace editor code.\n     * @param {object} root The root of the HTML document to modify.\n     */\n    function applyAceHighlighting(ace, root) {\n        var highlight = ace.require(\"ace/ext/static_highlight\");\n        var codeElements = root.getElementsByClassName('ace-highlight-code');\n\n        for (var i=0; i < codeElements.length; i++) {\n            let element = codeElements[i];\n            // Make sure we don't apply style twice, and do it only in moodle questions.\n            if (element.hasAttribute(\"ace-highlight-done\") || !element.closest(\"div[id^='question']\")) {\n                  continue;\n            }\n\n            var mode = \"ace/mode/python\";\n            if (element.hasAttribute(\"lang\")) {\n                mode = \"ace/mode/\" + element.getAttribute(\"lang\");\n            }\n\n            var startLineNumber = 1;\n            if (element.hasAttribute(\"start-line-number\")) {\n                startLineNumber = parseInt(element.getAttribute(\"start-line-number\"));\n            }\n\n            highlight(element, {\n                mode: mode,\n                showGutter: (element.hasAttribute(\"show-line-numbers\") || element.classList.contains(\"show-line-numbers\")),\n                firstLineNumber: startLineNumber\n            }, function() {\n                    var fontSize = \"14px\";\n                    if (element.hasAttribute(\"font-size\")) {\n                        fontSize = element.getAttribute(\"font-size\");\n                    }\n                    var children = element.getElementsByClassName('ace_static_highlight');\n                    if (children.length > 0) {  // How can there not be children?!\n                        children[0].style['font-size'] = fontSize ;\n                    } else {\n                    }\n                    element.setAttribute('ace-highlight-done', '');\n            });\n        }\n    }\n\n    return {\n        init: function() {\n            if (window.ace) {\n                applyAceHighlighting(window.ace, document);\n            }\n        }\n    };\n});"],"file":"highlight_code.min.js"}